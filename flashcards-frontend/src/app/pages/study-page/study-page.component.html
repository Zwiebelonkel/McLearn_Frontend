<div class="container">
    <a routerLink="/" class="back-link">‚Üê Back</a>
    <h2 class="page-title">Study</h2>

    <ng-container *ngIf="current(); else empty">
      <div class="card-wrapper">
        <div class="card" [class.flipped]="showBack()" (click)="flip()">
          <div class="card-inner">
            <div class="card-front">
              <span class="difficulty-label box-{{ current()?.box }}">
                {{ getBoxLabel(current()?.box) }}
              </span>
              <p>{{ current()?.front }}</p>
            </div>
            <div class="card-back">
              <div [innerHTML]="renderMarkdown(current()?.back || '')"></div>
            </div>
          </div>
        </div>
      </div>

      <div *ngIf="showBack()">
        <div *ngIf="isOwner()" class="ratings">
          <button (click)="rate('again')" class="btn btn-danger">Again</button>
          <button (click)="rate('hard')" class="btn btn-warning">Hard</button>
          <button (click)="rate('good')" class="btn btn-success">Good</button>
          <button (click)="rate('easy')" class="btn btn-info">Easy</button>
        </div>
        <div *ngIf="!isOwner()">
          <button (click)="loadCard()" class="btn btn-primary">Next</button>
        </div>
      </div>
    </ng-container>

    <ng-template #empty>
      <p>No card found. Create cards or wait until some are due.</p>
    </ng-template>
  </div>